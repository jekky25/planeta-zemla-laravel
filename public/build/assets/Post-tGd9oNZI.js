import{M as L}from"./MainLayout-BzcHKsFX.js";import{j as l,f as d,o as a,a as i,b as s,g as c,w as u,e as r,d as v,F as b,W as k,l as j,n as B,t as g,u as V,P as y,c as M}from"./app-B5JsSv7S.js";import{c as T,a as w,b as H,L as z,d as E,S as F,G as I}from"./ajax-DzZeUtz3.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={name:"FormAddComment",props:["post"],components:{GoogleCaptcha:I,SubmitButton:F,LabelInput:E,LabelTextarea:z},data(){return{id:0,name:"",email:"",message:"",post_id:0,recaptcha_response:"",data:Object}},mixins:[T,w,H],methods:{JCommentsInitializeForm(t){var e=new JCommentsEditor("comments-form-comment",!0);e.addButton("b","Жирный","Введите текст для форматирования"),e.addButton("i","Курсив","Введите текст для форматирования"),e.addButton("u","Подчеркнутый","Введите текст для форматирования"),e.addButton("s","Зачеркнутый","Введите текст для форматирования"),e.addButton("quote","Цитата","Введите текст цитаты"),e.addButton("custombbcode1","YouTube Video","Введите текст для форматирования","[youtube]","[/youtube]","bbcode-youtube",""),e.addButton("custombbcode4","Google Video","Введите текст для форматирования","[google]","[/google]","bbcode-google",""),e.addButton("custombbcode8","Facebook Video","Введите текст для форматирования","[fv]","[/fv]","bbcode-facebook",""),e.addButton("custombbcode10","Wikipedia","Введите текст для форматирования","[wiki]","[/wiki]","bbcode-wiki",""),e.initSmiles("/images/smiles"),e.addSmile(":D","laugh.gif"),e.addSmile(":lol:","lol.gif"),e.addSmile(":-)","smile.gif"),e.addSmile(";-)","wink.gif"),e.addSmile("8)","cool.gif"),e.addSmile(":-|","normal.gif"),e.addSmile(":-*","whistling.gif"),e.addSmile(":oops:","redface.gif"),e.addSmile(":sad:","sad.gif"),e.addSmile(":cry:","cry.gif"),e.addSmile(":o","surprised.gif"),e.addSmile(":-?","confused.gif"),e.addSmile(":-x","sick.gif"),e.addSmile(":eek:","shocked.gif"),e.addSmile(":zzz","sleeping.gif"),e.addSmile(":P","tongue.gif"),e.addSmile(":roll:","rolleyes.gif"),e.addSmile(":sigh:","unsure.gif"),e.addCounter(1e3,"Осталось:"," символов","counter"),t.setForm(new JCommentsForm("comments-form",e))},saveComment(){return this.clearParams(),this.checkName(this.$refs.name.get()),this.checkEMail(this.$refs.email.get()),this.checkMessage(this.$refs.message.get()),this.isError()||(this.getData(),this.ajax(route("comment.store",this.$data))),!1},getData(){this.$data.name=this.$refs.name.get(),this.$data.email=this.$refs.email.get(),this.$data.message=document.getElementById("comments-form-comment").value,this.$data._token=this.csrf_field,this.$data.post_id=this.post.id,this.recaptcha_response=document.getElementById("recaptchaResponse").value},ajaxError(t){this.$data.errors+="<p>"+t.response.data.message+"</p>",this.reloadCaptcha()},ajaxSuccess(t){let e=t.data.success;k.reload(),e==1&&(this.success="<p>Спасибо! Сообщение успешно добавлено!</p>",this.reloadCaptcha())}},mounted(){var t=new JComments(this.post.id,"com_content",route("comment.ajax"));t.setList("comments-list"),this.JCommentsInitializeForm(t)}},P={id:"comments-form",name:"comments-form",action:"javascript:void(null);"},q=["value"],G=["innerHTML"],J=["innerHTML"],N={id:"comments-form-buttons"},D={class:"btn",id:"comments-form-send"},O={class:"btn",id:"comments-form-cancel",style:{display:"none"}},R=["value"];function U(t,e,o,n,m,h){const p=l("Link"),C=l("GoogleCaptcha"),_=l("LabelInput"),x=l("LabelTextarea"),S=l("SubmitButton");return a(),d(b,null,[i(p,{id:"addcomments",href:"#addcomments"}),s("form",P,[s("input",{type:"hidden",name:"_token",autocomplete:"off",value:t.$attrs.csrf_field},null,8,q),t.success?(a(),d("div",{key:0,class:"success-text",innerHTML:t.success},null,8,G)):c("",!0),t.errors?(a(),d("div",{key:1,class:"error-text",innerHTML:t.errors},null,8,J)):c("",!0),i(C,{ref:"googleCaptcha"},null,512),i(_,{ref:"name",modelValue:m.name,"onUpdate:modelValue":e[0]||(e[0]=f=>m.name=f),type:"text",name:"name",id:"comments-form-name"},{default:u(()=>e[4]||(e[4]=[r(" Введите ваше имя:")])),_:1},8,["modelValue"]),i(_,{ref:"email",modelValue:m.email,"onUpdate:modelValue":e[1]||(e[1]=f=>m.email=f),type:"text",name:"email",id:"comments-form-email"},{default:u(()=>e[5]||(e[5]=[r(" E-mail адрес:")])),_:1},8,["modelValue"]),i(x,{ref:"message",modelValue:m.message,"onUpdate:modelValue":e[2]||(e[2]=f=>m.message=f),name:"message",id:"comments-form-comment",rows:"10"},{default:u(()=>e[6]||(e[6]=[r(" Введите текст вашего сообщения:")])),_:1},8,["modelValue"]),s("div",N,[s("div",D,[i(S,{onClick:e[3]||(e[3]=v(f=>{h.saveComment()},["prevent"]))},{default:u(()=>e[7]||(e[7]=[r("Отправить")])),_:1})]),s("div",O,[s("div",null,[i(p,{href:"#",tabindex:"8",onclick:"return false;",title:"Отменить"},{default:u(()=>e[8]||(e[8]=[r("Отменить")])),_:1})])]),e[9]||(e[9]=s("div",{style:{clear:"both"}},null,-1))]),s("input",{type:"hidden",name:"object_id",value:o.post.id},null,8,R),e[10]||(e[10]=s("input",{type:"hidden",name:"object_group",value:"com_content"},null,-1))])],64)}const W=$(A,[["render",U]]),Y={key:0,id:"jc"},K={id:"comments"},Q=["href"],X={id:"comments-list",class:"comments-list"},Z=["id"],ee={class:"rbox"},te={class:"rbox_m"},se={class:"comment-box usertype-guest"},oe={class:"comments-vote"},ne=["id"],ae=["onClick"],ie=["onClick"],de={class:"comment-author"},me={class:"comment-date"},le=["id","innerHTML"],re={class:"comments-buttons"},ce=["onClick"],ue={id:"comments-list-footer"},fe=["href"],he={name:"Comments",props:["post"],data(){return{errors:"",success:"",regexpEmail:/^(?:[a-z0-9._]+(?:[-_.]?[a-z0-9._]+)?@[a-z0-9_.-]+(?:\.?[a-z0-9]+)?\.[a-z]{2,5})$/i,id:0,name:"",email:"",message:"",post_id:0,recaptcha_response:"",data:Object}},methods:{voteComment(t,e){let o={vote:e};return axios.patch(route("post.update",{id:t}),o).then(n=>{k.reload(),this.$refs.formAddComment.reloadCaptcha()}).catch(n=>{this.errors=n.data}),!1},async ajax(t){let e;return await axios.get(t).then(o=>{e=o.data}).catch(o=>{this.$data.errors+="<p>"+o.response.data.message+"</p>"}),e},async quoteComment(t){let e=await this.ajax(route("comment.id.ajax",t)),o=this.$refs.formAddComment.message.length==0?"":`
`;o+="[quote]"+e.text+`[/quote]
`,this.$refs.formAddComment.message+=o}}},ge=Object.assign(he,{setup(t){return(e,o)=>t.post.comments?(a(),d("div",Y,[s("div",K,[s("h4",null,[o[0]||(o[0]=r("Комментарии ")),s("a",{class:"rss",href:e.route("comment.rss",[t.post.category.slug,t.post.id,t.post.slug]),title:"RSS лента комментариев этой записи",target:"_blank"}," ",8,Q)]),s("div",X,[(a(!0),d(b,null,j(t.post.comments,(n,m)=>(a(),d("div",{class:"even",id:`comment-item-${n.id}`},[s("div",ee,[o[2]||(o[2]=s("div",{class:"rbox_tr"},[s("div",{class:"rbox_tl"},[s("div",{class:"rbox_t"}," ")])],-1)),s("div",te,[s("div",se,[s("span",oe,[s("span",{id:`comment-vote-holder-${n.id}`},[n.votes?(a(),d("a",{key:0,href:"#",class:"vote-good",title:"Хороший комментарий!",onClick:v(h=>{e.voteComment(n.id,1)},["prevent"])},null,8,ae)):c("",!0),n.votes?(a(),d("a",{key:1,href:"#",class:"vote-poor",title:"Плохой комментарий!",onClick:v(h=>{e.voteComment(n.id,-1)},["prevent"])},null,8,ie)):c("",!0),s("span",{class:B(n.voteClass)},g(n.voteCount),3)],8,ne)]),i(V(y),{class:"comment-anchor",href:`${e.route("item.name",[t.post.category.slug,t.post.id,t.post.slug])}#comment-${t.post.id}`,id:`comment-${t.post.id}`},{default:u(()=>[r("#"+g(m),1)]),_:2},1032,["href","id"]),s("span",de,g(n.name),1),s("span",me,g(n.date),1),s("div",{class:"comment-body",id:`comment-body-${n.id}`,innerHTML:n.text},null,8,le),s("span",re,[s("a",{href:"#",onClick:v(h=>{e.quoteComment(n.id)},["prevent"])},"Цитировать",8,ce)])]),o[1]||(o[1]=s("div",{class:"clear"},null,-1))]),o[3]||(o[3]=s("div",{class:"rbox_br"},[s("div",{class:"rbox_bl"},[s("div",{class:"rbox_b"}," ")])],-1))])],8,Z))),256))]),s("div",ue,[s("a",{class:"rss",href:e.route("comment.rss",[t.post.category.slug,t.post.id,t.post.slug]),target:"_blank"},"RSS лента комментариев этой записи",8,fe)])]),i(W,{ref:"formAddComment",post:t.post},null,8,["post"])])):c("",!0)}}),pe={name:"Page",components:{Link:y,Comments:ge},layout:L,props:["post"]},_e={key:0,class:"contentheading"},ve={class:"article-content"},be=["innerHTML"],Ce=["innerHTML"];function ke(t,e,o,n,m,h){const p=l("Head"),C=l("Link"),_=l("Comments");return a(),d(b,null,[o.post?(a(),M(p,{key:0,title:`${o.post.title} Земля как планета`},null,8,["title"])):c("",!0),o.post?(a(),d(b,{key:1},[e[0]||(e[0]=s("div",{class:"componentheading"},null,-1)),o.post.category?(a(),d("h2",_e,[i(C,{href:t.route("item.name",[o.post.category.slug,o.post.id,o.post.slug]),class:"contentpagetitle"},{default:u(()=>[r(g(o.post.title),1)]),_:1},8,["href"])])):c("",!0),s("div",ve,[s("span",{innerHTML:o.post.introtext},null,8,be),s("span",{innerHTML:o.post.fulltext},null,8,Ce)]),i(_,{post:o.post},null,8,["post"])],64)):c("",!0)],64)}const Le=$(pe,[["render",ke]]);export{Le as default};
